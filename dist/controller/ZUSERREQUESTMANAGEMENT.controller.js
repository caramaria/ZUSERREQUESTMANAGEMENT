sap.ui.define(["sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/mvc/Controller"],function(e,t,a){"use strict";return a.extend("ZUSERREQUESTMANAGEMENT.ZUSERREQUESTMANAGEMENT.controller.ZUSERREQUESTMANAGEMENT",{onBeforeRendering:function(){this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);var e=jQuery.sap.getUriParameters();if(e.get("pwreset")==="true"){this.oRouter.navTo("RESETPASSWORD")}else if(e.get("RequestID")!==null){this.oRouter.navTo("ACTIVATIONSUCCESS")}else{return}},onInit:function(){var e=new sap.ui.model.json.JSONModel;var t={gender:"",prefix:"",firstName:"",lastName:"",email:"",phoneWork:"",phone:"",street:"",housenumber:"",city:"",plz:"",birthday:undefined,birthplace:"",fax:"",password1:"",password2:"",privacyCheck:false};e.setData(t);this.getView().setModel(e,"basicInfo")},onSubmit:function(a){var i=this.getView().getModel("basicInfo").getData();var r=this.getView().byId("Select_Anrede_id").getSelectedKey();var s=this.getView().byId("Select_Titel_id").getSelectedKey();var o=i.firstName;var n=i.lastName;var u=i.birthday;var l=i.birthplace;var d=i.street;var h=i.housenumber;var S=i.city;var c=i.plz;var p=i.email;var w=i.phoneWork;var V=i.phone;var g=i.fax;var b=i.password1;var f=i.password2;var m;if(i.privacyCheck===true){m="1"}else{m=0}var E=this.checkRequiredFields(i);if(E==true){var v=this.getOwnerComponent().getModel("userRequestModel");v.create("/UserRequestCollection",{UserName:p,FirstName:o,LastName:n,EmailAddress:p,PhoneNumber:w,UsrCategory:"001",Password:f,Street:d,PLZ:c,City:S,Birthdate:u,Birthplace:l,Fax:g,Gender:r,Housenumber:h,Mobile:V,DSVO:m},{success:function(t,a){e.show("Benutzeranfrage wurde erfolgreich gesendet");this.getView().getModel("basicInfo").setData(null);this.oRouter.navTo("REGISTERSUCCESS")}.bind(this),error:function(e){var a=JSON.parse(e.responseText);var i=a.error.message.value;t.error(i)}.bind(this)})}},onCancel:function(e){window.location.href="/oa#zonlineapplication-maintain"},checkRequiredFields:function(t){if(this.getView().byId("Select_Anrede_id").getSelectedKey()==""){e.show("Bitte wählen Sie eine Anrede aus");this.getView().byId("Select_Anrede_id").setValueState(sap.ui.core.ValueState.Error)}else if(t.lastName==""){e.show("Bitte geben Sie einen Familiennamen an");this.getView().byId("inputLastName").setValueState(sap.ui.core.ValueState.Error)}else if(t.firstName==""){e.show("Bitte geben Sie einen Vornamen an");this.getView().byId("inputFirstname").setValueState(sap.ui.core.ValueState.Error)}else if(t.street==""){e.show("Bitte geben Sie eine Straße an");this.getView().byId("inputSreet").setValueState(sap.ui.core.ValueState.Error)}else if(t.housenumber==""){e.show("Bitte geben Sie eine Hausnummer an");this.getView().byId("no").setValueState(sap.ui.core.ValueState.Error)}else if(t.city==""){e.show("Bitte geben Sie einen Ort an");this.getView().byId("no").setValueState(sap.ui.core.ValueState.Error)}else if(t.plz==""){e.show("Bitte geben Sie eine Postleitzahl an");this.getView().byId("inputCity").setValueState(sap.ui.core.ValueState.Error)}else if(t.phoneWork==""){e.show("Bitte geben Sie eine Telefonnummer an");this.getView().byId("inputPhoneWork").setValueState(sap.ui.core.ValueState.Error)}else if(t.email==""){e.show("Bitte geben Sie eine E-Mail Adresse an");this.getView().byId("inputEmail").setValueState(sap.ui.core.ValueState.Error)}else if(t.password1==""){e.show("Bitte geben Sie ein Passwort an");this.getView().byId("inputPasswprd").setValueState(sap.ui.core.ValueState.Error)}else if(t.password2==""){e.show("Bitte wiederholen Sie Ihr Passwort");this.getView().byId("password2").setValueState(sap.ui.core.ValueState.Error)}else if(t.privacyCheck==false){e.show("Bitte akzeptieren Sie die Datenschutzbestimmungen");this.getView().byId("privacyCheckbox").setValueState(sap.ui.core.ValueState.Error)}else{if(t.password1!=t.password2){e.show("Passwörter stimmen nicht überein");this.getView().byId("inputPasswprd").setValueState(sap.ui.core.ValueState.Error);this.getView().byId("password2").setValueState(sap.ui.core.ValueState.Error)}else{return true}}},emailVerification:function(){var e=this.getView().byId("inputEmail").getValue();var a=/^\w+[\w-+\.]*\@\w+([-\.]\w+)*\.[a-zA-Z]{2,}$/;if(!a.test(e)){t.error(e+" is not a valid email address");this.getView().byId("inputEmail").setValueState(sap.ui.core.ValueState.Error)}}})});